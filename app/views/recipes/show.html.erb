<p style="color: green"><%= notice %></p>
  <%= render partial: "recipe", locals: {recipe_display: 'details', recipe: @recipe} %>

<div>
  <%= link_to "Edit this recipe", edit_recipe_path(@recipe) %> |
  <%= link_to "Back to recipes", recipes_path %>

  <button data-micromodal-trigger="modal-1" type="button">Generate</button>
  <%= button_to "Add ingredient", new_recipe_recipe_food_path(@recipe), method: :get %>
  <hr>
  <table id = "ingredients">
    <thead>
      <tr>
        <th>Food</th>
        <th>Quantity</th>
        <th>Price</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @recipe.recipe_foods.each do |recipe_food| %>
        <tr>
          <%= render "recipe_foods/recipe_food_record", recipe_food: recipe_food %>
          <td class="actions">
            <%= link_to "Modify", edit_recipe_recipe_food_path(@recipe, recipe_food) %>
            <%= link_to "Remove", recipe_recipe_food_path(@recipe, recipe_food), data: { turbo_method: :delete, turbo_confirm: "Are you  sure?"} %>            
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
<div class="modal micromodal-slide" id="modal-1" aria-hidden="true">
  <div class="modal__overlay" tabindex="-1" data-micromodal-close>
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
      <header class="modal__header">
        <h2 class="modal__title" id="modal-1-title">
          Generating Shopping List
        </h2>
        <button class="modal__close" aria-label="Close modal" data-micromodal-close></button>
      </header>
      <main class="modal__content" id="modal-1-content">
        <p>
        Choose an inventory to use.
        </p>

        <%= form_with url: shopping_list_path, method: :get  do |form| %>
          <%= hidden_field(:recipe, :id, name: 'recipe_id') %>
          
          <div>
            <%= form.label :inventory_id, style: "display: block" %>
            <%= form.select :inventory_id, Inventory.all.map {|inventory| [inventory.name, inventory.id]} %>
          </div>
        
          <div>
            <%= form.submit "Generate" %>
          </div>
        <% end %>

      </main>
    </div>
  </div>
</div>
